!function(e,t,a){var s=e(document);(t=t||{}).updates=t.updates||{},t.updates.l10n=_.extend(t.updates.l10n,a.l10n||{}),t.updates.addAdminNotice=function(a){var i,d=e(a.selector),n=e(".wp-header-end");delete a.selector,i=t.updates.adminNotice(a),d.length||(d=e("#"+a.id)),d.length?d.replaceWith(i):n.length?e(".wp-header-end").after(i):e(".wrap").find("> h1").after(i),s.trigger("wp-updates-notice-added")},t.updates.bulkInstallPlugin=function(e){return e=_.extend({success:t.updates.bulkInstallPluginSuccess,error:t.updates.bulkInstallPluginError},e),s.trigger("wp-bulk-plugins-installing",e),t.updates.ajax("install-bulk-plugins",e)},t.updates.importDemo=function(a){var i=e('.demo-import[data-slug="'+a.slug+'"]');return a=_.extend({success:t.updates.importDemoSuccess,error:t.updates.importDemoError},a),i.addClass("updating-message"),i.parents(".theme").addClass("focus"),i.html()!==t.updates.l10n.importing&&i.data("originaltext",i.html()),i.text(t.updates.l10n.importing).attr("aria-label",t.updates.l10n.demoImportingLabel.replace("%s",i.data("name"))),t.a11y.speak(t.updates.l10n.importingMsg,"polite"),e('.theme-info .theme-description, [data-slug="'+a.slug+'"]').removeClass("demo-import-failed").find(".notice.notice-error").remove(),s.trigger("wp-demo-importing",a),t.updates.ajax("import-demo",a)},t.updates.importDemoSuccess=function(a){var i,d=e(".theme-overlay, [data-slug="+a.slug+"]");s.trigger("wp-demo-import-success",a),i=d.find(".button-primary").removeClass("updating-message").addClass("updated-message disabled").attr("aria-label",t.updates.l10n.demoImportedLabel.replace("%s",a.demoName)).text(t.updates.l10n.imported),t.a11y.speak(t.updates.l10n.importedMsg,"polite"),setTimeout(function(){a.previewUrl&&(i.siblings(".demo-preview").remove(),i.attr("target","_blank").attr("href",a.previewUrl).removeClass("demo-import updated-message disabled").addClass("live-preview").attr("aria-label",t.updates.l10n.livePreviewLabel.replace("%s",a.demoName)).text(t.updates.l10n.livePreview))},1e3)},t.updates.importDemoError=function(a){var i,d=t.updates.l10n.importFailed.replace("%s",a.errorMessage),n=t.updates.adminNotice({className:"update-message notice-error notice-alt",message:d});t.updates.isValidResponse(a,"import")&&(s.find("body").hasClass("modal-open")||s.find(".themes").hasClass("single-theme")?(i=e('.demo-import[data-slug="'+a.slug+'"]'),e(".theme-info .theme-description").prepend(n)):i=e('[data-slug="'+a.slug+'"]').removeClass("focus").addClass("demo-import-failed").append(n).find(".demo-import"),i.removeClass("updating-message").attr("aria-label",t.updates.l10n.demoImportFailedLabel.replace("%s",i.data("name"))).text(t.updates.l10n.importFailedShort),t.a11y.speak(d,"assertive"),s.trigger("wp-demo-import-error",a))},t.updates.deleteDemo=function(a){var i=e(".theme-actions .delete-demo");return a=_.extend({success:t.updates.deleteDemoSuccess,error:t.updates.deleteDemoError},a),i&&i.html()!==t.updates.l10n.deleting&&i.data("originaltext",i.html()).text(t.updates.l10n.deleting),t.a11y.speak(t.updates.l10n.deleting,"polite"),e(".theme-info .update-message").remove(),s.trigger("wp-demo-deleting",a),t.updates.ajax("delete-demo",a)},t.updates.deleteDemoSuccess=function(e){t.a11y.speak(t.updates.l10n.deleted,"polite"),s.trigger("wp-demo-delete-success",e)},t.updates.deleteDemoError=function(a){var i=e(".theme-actions .delete-demo"),d=t.updates.l10n.deleteFailed.replace("%s",a.errorMessage),n=t.updates.adminNotice({className:"update-message notice-error notice-alt",message:d});t.updates.maybeHandleCredentialError(a,"delete-demo")||(e(".theme-info .theme-description").before(n),i.html(i.data("originaltext")),t.a11y.speak(d,"assertive"),s.trigger("wp-demo-delete-error",a))},t.updates.isValidResponse=function(a,s){var i,d=t.updates.l10n.unknownError;if(_.isObject(a)&&!_.isFunction(a.always))return!0;switch(_.isString(a)&&"-1"===a?d=t.updates.l10n.nonceError:_.isString(a)?d=a:"undefined"!=typeof a.readyState&&0===a.readyState?d=t.updates.l10n.connectionError:_.isString(a.statusText)&&(d=a.statusText+" "+t.updates.l10n.statusTextLink),s){case"import":i=t.updates.l10n.importFailed}return i=i.replace("%s",d),t.updates.addAdminNotice({id:"unknown_error",className:"notice-error is-dismissible",message:_.unescape(i)}),e(".button.updating-message").removeClass("updating-message").removeAttr("aria-label").text(t.updates.l10n.updateFailedShort),t.a11y.speak(i,"assertive"),!1},t.updates.queueChecker=function(){var e;if(!t.updates.ajaxLocked&&t.updates.queue.length){switch((e=t.updates.queue.shift()).action){case"import-demo":t.updates.importDemo(e.data);break;case"delete-demo":t.updates.deleteDemo(e.data);break;case"install-plugin":t.updates.installPlugin(e.data)}s.trigger("wp-updates-queue-job",e)}},e(function(){s.on("click","a.plugins-install",function(a){var i,d=s.find('input[name="checked[]"]:checked'),n=0,r=0,o=[];e(".theme-info .update-message").remove(),d.length||(a.preventDefault(),e("html, body").animate({scrollTop:0}),i=t.updates.adminNotice({id:"no-items-selected",className:"update-message notice-error notice-alt",message:t.updates.l10n.noItemsSelected}),e(".theme-info .plugins-info").after(i)),window.confirm("Are you sure?")?(t.updates.maybeRequestFilesystemCredentials(a),a.preventDefault(),s.find('.manage-column [type="checkbox"]').prop("checked",!1),s.trigger("wp-plugin-bulk-install",d),d.each(function(a,s){var i=e(s),d=i.parents("tr");d.hasClass("install")&&!d.find("notice-error").length?t.updates.queue.push({action:"install-plugin",data:{plugin:d.data("plugin"),slug:d.data("slug")}}):i.prop("checked",!1)}),s.on("wp-plugin-install-success wp-plugin-install-error",function(a,s){var d,l,p=e('[data-slug="'+s.slug+'"]');"wp-"+s.update+"-update-success"===a.type?n++:(l=s.pluginName?s.pluginName:p.find(".column-primary strong").text(),r++,o.push(l+": "+s.errorMessage)),p.find('input[name="checked[]"]:checked').prop("checked",!1),t.updates.adminNotice=t.template("wp-bulk-updates-admin-notice"),e(".theme-info .bulk-action-notice").remove(),i=t.updates.adminNotice({id:"bulk-action-notice",className:"bulk-action-notice notice-alt",successes:n,errors:r,errorMessages:o,type:s.update}),e(".theme-info .plugins-info").after(i),d=e("#bulk-action-notice").on("click","button",function(){e(this).toggleClass("bulk-action-errors-collapsed").attr("aria-expanded",!e(this).hasClass("bulk-action-errors-collapsed")),d.find(".bulk-action-errors").toggleClass("hidden")}),r>0&&!t.updates.queue.length&&e("html, body").animate({scrollTop:0})}),s.on("wp-updates-notice-added",function(){t.updates.adminNotice=t.template("wp-updates-admin-notice")}),t.updates.queueChecker()):a.preventDefault()})})}(jQuery,window.wp,window._demoUpdatesSettings);